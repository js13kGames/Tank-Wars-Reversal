!function(t){function n(t){if(m){if(r+s>t)return void(e=h(n));for(o+=t-r,r=t,t>a+1e3&&(u=.25*f+.75*u,a=t,f=0),f++,c=0;o>=i;)if(D(i),o-=i,++c>=240){d=!0;break}M(o/i),d=!1,e=h(n)}}var e,i=1e3/60,o=0,r=0,u=60,a=0,f=0,c=0,s=0,m=!1,p=!1,d=!1,h=t.requestAnimationFrame||function(){var t,n,e=Date.now();return function(o){return t=Date.now(),n=Math.max(0,i-(t-e)),e=t+n,setTimeout(function(){o(t+n)},n)}}(),l=t.cancelAnimationFrame||clearTimeout,v=function(){},D=v,M=v;t.MainLoop={resetFrameDelta:function(){var t=o;return o=0,t},setUpdate:function(t){return D=t||D,this},setDraw:function(t){return M=t||M,this},start:function(){return p||(p=!0,e=h(function(t){M(1),m=!0,r=t,a=t,f=0,e=h(n)})),this},stop:function(){return m=!1,p=!1,l(e),this}},"function"==typeof define&&define.amd?define(t.MainLoop):"object"==typeof exports&&(module.exports=t.MainLoop)}(this);
